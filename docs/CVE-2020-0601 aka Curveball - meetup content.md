# CVE-2020-0601 aka Curveball - meetup content



## CVE-2020-0601 Vulnerability

- TL;DL; cache for validated certificates was implemented in a way that it allowed spoofed cert to be used on a server allowing several vectors of attack (MITM, etc..)

In order to understand what happened we have to revisit some of the following topics:

- Elliptic Curve Cryptography - ECC

- Chain of Trust

  

## Elliptic Curve Cryptography

- Public Key Cryptography 
  - encrypt data and transport it without exposing private key
  - trapdoor functions
    - easy to go one way, hard to undo
- RSA - most popular
  - multiplication of 2 (generally really big) prime numbers
- Elliptic Curve Cryptography - relatively new

- EC is a curve which satisfies the equation

$$
y^2 = x^3 + ax + b
$$

- How EC looks like:

![](\images\image-20200303092849710.png)

- How EC works:

![img](https://miro.medium.com/max/410/0*4hLA8ig3E4FnmScs.gif)

- Trapdoor function: elliptic curve discrete logarithm function

$$
Q = x*G
$$

$$
x!= Q/P
$$

- domain parameters

$$
T = (p,a,b,G,n,h)
$$

- example of a specification for the elliptic curve: http://secg.org/sec2-v2.pdf

  ![image-20200303121643424](..\images\image-20200303121643424.png)

- example - simple curve

  ![image-20200303183406026](.\images\image-20200303183406026.png)

- example - simple curve communication

  ![image-20200303183429876](.\images\image-20200303183429876.png)

  

- example:

  ![image-20200303183501587](.\images\image-20200303183501587.png)



#### ECC vs. RSA

- smaller key size

| RSA (modulus size in bits) | ECC Key Size in bits |
| -------------------------- | -------------------- |
| 512                        | 112                  |
| 1024                       | 160                  |
| 2048                       | 224                  |
| 3072                       | 256                  |
| 7680                       | 384                  |
| 15360                      | 512                  |

- matters on devices like phones, etc...
- no resolution to the discrete log problem



### Chain of trust

- root CA certificate is not used directly on the certificate with the root CA private key but use intermediate certificate authorities

![image-20200303184236548](.\images\image-20200303184236548.png)



## How this fits into the CVE-2020-0601?

- vulnerability only available on certificates that were signed with the Elliptic Curve Algorithm

  ![image-20200303185302079](.\images\image-20200303185302079.png)

  

- there is a possibility that you define a curve that hasn't been implemented in the TLS alreday:

  

  ![image-20200303185404239](.\images\image-20200303185404239.png)

  

- Windows 10 machines have cache where they keep validated certificates but the validation is not complete

  ![image-20200303185641879](.\images\image-20200303185641879.png)



- this allows us to provide the certificate with custom curve parameters which could have a certificate whose Public Key == Private Key

- this is possible because of the Elliptic Curve

  ![image-20200303191421925](.\images\image-20200303191421925.png)
